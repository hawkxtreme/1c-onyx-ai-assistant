#Область ПрограммныйИнтерфейс

////////////////////////////////////////////////////////////////////////////////
// Публичный программный интерфейс

// Выполняет синхронизацию справочника агентов с Onyx.
Процедура СинхронизацияАгентов() Экспорт
	
	Попытка
		onyx_РаботаСАгентами.ПолучитьСписокАгентов(Истина);
	Исключение
		ЗафиксироватьОшибкуРегламентногоЗадания("СинхронизацияАгентов", ОписаниеОшибки());
	КонецПопытки;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

////////////////////////////////////////////////////////////////////////////////
// Вспомогательные функции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

////////////////////////////////////////////////////////////////////////////////
// Частные процедуры и функции

Процедура ЗафиксироватьОшибкуРегламентногоЗадания(ИмяЗадания, СообщениеОбОшибке)
	
	СообщитьСтроку = СтрШаблон("[%1][Ошибка] %2", ИмяЗадания, СообщениеОбОшибке);
	Попытка
		Сообщить(СообщитьСтроку);
	Исключение
		// Игнорируем ошибки вывода - они не критичны для работы регламентного задания.
		// Ошибки вывода не влияют на выполнение задания.
		// Ошибка намеренно игнорируется, так как вывод сообщения не является критичной операцией.
		ИгнорируемОшибку = Истина;
	КонецПопытки;
	
КонецПроцедуры

#КонецОбласти
